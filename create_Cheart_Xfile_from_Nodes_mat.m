function create_Cheart_Xfile_from_Nodes_mat(Lagrange_mesh_Nodes,Sim_prep_folder,X_file_name)

% created by Anastasia on 26-02-2020
%-------------------------------------------------------------------------------------------------------------------------
% Purpose: 
%-------------------------------------------------------------------------------------------------------------------------
% a function for printing a Nodes matrix into a .X file for use in
% simulations or data processing following Cheart style.

%-------------------------------------------------------------------------------------------------------------------------
% Notes on methodology:
%-------------------------------------------------------------------------------------------------------------------------

%-------------------------------------------------------------------------------------------------------------------------
% Input:
%-------------------------------------------------------------------------------------------------------------------------
% Lagrange_mesh_Nodes: nodes mat in format: [x,y,z] for 3D meshes, each row a different node ID
% Sim_prep_folder: folder where the X.file will be printed
% X_file_name: the full filename you want to use (e.g. X_file_name='Cubic_mesh_FE.X') 

%-------------------------------------------------------------------------------------------------------------------------
% Output:
%-------------------------------------------------------------------------------------------------------------------------

%-------------------------------------------------------------------------------------------------------------------------
% SOS points:
%-------------------------------------------------------------------------------------------------------------------------

% % % % % X_file_name='Lin_mesh_FE.X';

fid=fopen([Sim_prep_folder,'/',X_file_name],'w');
fprintf(fid,'%d %d\n',[size(Lagrange_mesh_Nodes,1),size(Lagrange_mesh_Nodes,2)].');
fprintf(fid,'%21.15f    %21.15f    %21.15f\n    ',Lagrange_mesh_Nodes.');
fclose(fid);